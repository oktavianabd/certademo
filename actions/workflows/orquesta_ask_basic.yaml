version: 1.0

description: A basic workflow that demonstrates inquiry.

tasks:
  start:
    action: core.echo message="Automation started."
    next:
      - when: <% succeeded() %>
        do: get_approval

  get_approval:
    action: core.ask
    input:
      schema:
        type: object
        properties:
          approved:
            type: boolean
            description: "Continue?"
            required: True

    next:
      - when: <% succeeded and task(get_approval).result.response.approved = true %>
        do: finish
      - when: <% succeeded and task(get_approval).result.response.approved = false %>
        do: stop

  finish:
    action: core.echo
    input:
      message: |
        Approved, Automation completed
        <% task("finish").task_execution_id %>
        <% task("finish").workflow_execution_id %>
        <% task("finish").task_name %>
        <% task("finish").task_id %>
        <% task("finish").route %>
        <% task("finish").result %>
        <% task("finish").status %>
        <% task("finish").start_timestamp %>
        <% task("finish").end_timestamp %>
       # <% st2kv('task("get_approval").task_execution_id', decrypt=>true) %> 
       # <% task("get_approval").action_execution_id %>



  stop:
    action: core.echo message="Un-approved, Automation stopped."
