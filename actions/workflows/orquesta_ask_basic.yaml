version: 1.0

description: A basic workflow that demonstrates inquiry.

tasks:
  start:
    action: core.echo message="Automation started."
    next:
      - when: <% succeeded() %>
        do: get_approval

  get_approval:
    action: core.ask
    input:
      schema:
        type: object
        properties:
          approved:
            type: boolean
            description: "Continue?"
            required: True
  #   next:
  #     - when: <% succeeded %>
  #       and:
  #         - when: <% result().response.approved = true %>
  #           do: finish
  #         - when: <% result().response.approved = false %>
  #           do: stop
  #     - when: <% failed %>
  #       do: failure
    
  # finish:
  #   action: core.echo message="Approved, Automation completed."
    
  # stop:
  #   action: core.echo message="Un-approved, Automation stopped."
  
  # failure:
  #   action: core.echo message="Automation error/failed"
            
    next:
      - when: <% succeeded and result().response.approved = true %>
        do: finish
      - when: <% succeeded and result().response.approved = false %>
        do: stop
      - when: <% failed %>
        do: failure

  finish:
    action: core.echo message="Approved, Automation completed."

  stop:
    action: core.echo message="Un-approved, Automation stopped."
  
  failure:
    action: core.echo message="Automation error/failed."